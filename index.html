<html lang="id" class="scroll-smooth">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Personal Savings - Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .glass-morphism {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.25);
            box-shadow: 0 12px 35px 0 rgba(31, 38, 135, 0.37);
        }

        .card-hover {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            transform-style: preserve-3d;
        }

        .card-hover:hover {
            transform: translateY(-10px) rotateX(5deg);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.2);
        }

        .floating-animation {
            animation: float 6s ease-in-out infinite;
        }

        @keyframes float {
            0%,
            100% {
                transform: translateY(0px);
            }
            50% {
                transform: translateY(-20px);
            }
        }

        .gradient-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .coin-animation {
            animation: coinFlip 2s linear infinite;
        }

        @keyframes coinFlip {
            0% {
                transform: rotateY(0deg);
            }
            100% {
                transform: rotateY(360deg);
            }
        }

        .sidebar {
            transform: translateX(-100%);
            transition: transform 0.3s ease;
        }

        .sidebar.active {
            transform: translateX(0);
        }

        .mobile-menu-overlay {
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .mobile-menu-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }

        .notification {
            transform: translateY(-100px);
            opacity: 0;
            transition: all 0.3s ease;
        }

        .notification.show {
            transform: translateY(0);
            opacity: 1;
        }

        .modal {
            opacity: 0;
            visibility: hidden;
            transform: scale(0.8);
            transition: all 0.3s ease;
        }

        .modal.active {
            opacity: 1;
            visibility: visible;
            transform: scale(1);
        }

        .data-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.15) 0%, rgba(255, 255, 255, 0.08) 100%);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.15);
        }

        .action-button {
            position: relative;
            overflow: hidden;
            font-weight: 600;
        }

        .action-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s;
        }

        .action-button:hover::before {
            left: 100%;
        }

        .loading-spinner {
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top: 3px solid #ffffff;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }

        .login-container {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.2) 0%, rgba(255, 255, 255, 0.1) 100%);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .pin-input {
            width: 50px;
            height: 50px;
            font-size: 24px;
            font-weight: bold;
            text-align: center;
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: white;
            border-radius: 12px;
            transition: all 0.3s ease;
        }

        .pin-input:focus {
            border-color: #667eea;
            background: rgba(255, 255, 255, 0.3);
            outline: none;
        }

        .goal-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }

        .goal-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        }

        .settings-card {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.12) 0%, rgba(255, 255, 255, 0.06) 100%);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.18);
        }

        @media (max-width: 768px) {
            .chart-container {
                height: 250px;
            }
            .pin-input {
                width: 45px;
                height: 45px;
                font-size: 20px;
            }
        }

        .scroll-indicator {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            z-index: 9999;
        }

        .scroll-progress {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2, #f093fb);
            width: 0%;
            transition: width 0.1s ease;
        }

        .login-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 30%, #f093fb 70%, #f5576c 100%);
            position: relative;
            overflow: hidden;
        }

        .login-bg::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="20" cy="20" r="2" fill="rgba(255,255,255,0.1)"/><circle cx="80" cy="30" r="1.5" fill="rgba(255,255,255,0.1)"/><circle cx="40" cy="70" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="90" cy="80" r="2.5" fill="rgba(255,255,255,0.05)"/><circle cx="10" cy="90" r="1.5" fill="rgba(255,255,255,0.1)"/></svg>');
            animation: sparkle 10s linear infinite;
        }

        @keyframes sparkle {
            0% {
                transform: translateY(0) rotate(0deg);
            }
            100% {
                transform: translateY(-100px) rotate(360deg);
            }
        }

        .pulse-animation {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%,
            100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="login-bg fixed inset-0 z-50 flex items-center justify-center p-4">
        <div class="login-container rounded-3xl p-8 w-full max-w-md mx-auto shadow-2xl">
            <div class="text-center mb-8">
                <div class="w-20 h-20 bg-white/20 rounded-full flex items-center justify-center mx-auto mb-4 floating-animation">
                    <i class="fas fa-piggy-bank text-4xl text-white"></i>
                </div>
                <h1 class="text-3xl font-bold text-white mb-2">Personal Savings</h1>
                <p class="text-white/80">Masuk ke akun Anda</p>
            </div>

            <!-- Login Method Toggle -->
            <div class="flex bg-white/10 rounded-full p-1 mb-6">
                <button id="loginModeUser" class="flex-1 py-2 px-4 rounded-full text-white font-medium transition-all duration-300 bg-white/20">
                    Username
                </button>
                <button id="loginModePIN" class="flex-1 py-2 px-4 rounded-full text-white/70 font-medium transition-all duration-300">
                    PIN
                </button>
            </div>

            <!-- Username Login Form -->
            <form id="userLoginForm" class="space-y-4">
                <div>
                    <label class="block text-white/90 mb-2 font-medium">Username</label>
                    <input
                        type="text"
                        id="username"
                        class="w-full bg-white/20 text-white rounded-xl px-4 py-3 border border-white/30 focus:border-white focus:outline-none transition-all placeholder-white/60"
                        placeholder="Masukkan username"
                        required
                    />
                </div>
                <div>
                    <label class="block text-white/90 mb-2 font-medium">Password</label>
                    <input
                        type="password"
                        id="password"
                        class="w-full bg-white/20 text-white rounded-xl px-4 py-3 border border-white/30 focus:border-white focus:outline-none transition-all placeholder-white/60"
                        placeholder="Masukkan password"
                        required
                    />
                </div>
                <button
                    type="submit"
                    class="w-full action-button bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105"
                >
                    <i class="fas fa-sign-in-alt mr-2"></i>Masuk
                </button>
            </form>

            <!-- PIN Login Form -->
            <form id="pinLoginForm" class="space-y-4 hidden">
                <div>
                    <label class="block text-white/90 mb-4 font-medium text-center">Masukkan PIN (6 digit)</label>
                    <div class="flex justify-center space-x-3">
                        <input type="password" maxlength="1" class="pin-input" required />
                        <input type="password" maxlength="1" class="pin-input" required />
                        <input type="password" maxlength="1" class="pin-input" required />
                        <input type="password" maxlength="1" class="pin-input" required />
                        <input type="password" maxlength="1" class="pin-input" required />
                        <input type="password" maxlength="1" class="pin-input" required />
                    </div>
                </div>
                <button
                    type="submit"
                    class="w-full action-button bg-gradient-to-r from-green-500 to-blue-600 hover:from-green-600 hover:to-blue-700 text-white py-3 rounded-xl font-semibold transition-all duration-300 transform hover:scale-105"
                >
                    <i class="fas fa-unlock mr-2"></i>Buka Kunci
                </button>
            </form>

            <div class="text-center mt-6">
                <p class="text-white/60 text-sm"></p>
            </div>
        </div>
    </div>

    <!-- Main App (Hidden initially) -->
    <div id="mainApp" class="hidden">
        <!-- Scroll Progress Indicator -->
        <div class="scroll-indicator">
            <div class="scroll-progress" id="scrollProgress"></div>
        </div>

        <!-- Mobile Menu Overlay -->
        <div class="mobile-menu-overlay fixed inset-0 bg-black bg-opacity-50 z-40" id="mobileOverlay"></div>

        <!-- Sidebar -->
        <aside class="sidebar fixed left-0 top-0 h-full w-64 glass-morphism z-50 p-6" id="sidebar">
            <div class="flex items-center justify-between mb-8">
                <h2 class="text-xl font-bold text-white">Menu</h2>
                <button class="text-white hover:text-gray-300 lg:hidden" id="closeSidebar">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>

            <nav class="space-y-2">
                <a
                    href="#dashboard"
                    class="nav-item flex items-center space-x-3 text-white hover:text-blue-300 transition-colors p-3 rounded-xl hover:bg-white/15 font-medium"
                >
                    <i class="fas fa-chart-line w-5"></i>
                    <span>Dashboard</span>
                </a>
                <a
                    href="#transactions"
                    class="nav-item flex items-center space-x-3 text-white hover:text-blue-300 transition-colors p-3 rounded-xl hover:bg-white/15 font-medium"
                >
                    <i class="fas fa-exchange-alt w-5"></i>
                    <span>Transaksi</span>
                </a>
                <a
                    href="#goals"
                    class="nav-item flex items-center space-x-3 text-white hover:text-blue-300 transition-colors p-3 rounded-xl hover:bg-white/15 font-medium"
                >
                    <i class="fas fa-bullseye w-5"></i>
                    <span>Target Tabungan</span>
                </a>
                <a
                    href="#reports"
                    class="nav-item flex items-center space-x-3 text-white hover:text-blue-300 transition-colors p-3 rounded-xl hover:bg-white/15 font-medium"
                >
                    <i class="fas fa-chart-pie w-5"></i>
                    <span>Laporan</span>
                </a>
                <a
                    href="#settings"
                    class="nav-item flex items-center space-x-3 text-white hover:text-blue-300 transition-colors p-3 rounded-xl hover:bg-white/15 font-medium"
                >
                    <i class="fas fa-cog w-5"></i>
                    <span>Pengaturan</span>
                </a>
                <div class="border-t border-white/20 pt-4 mt-6">
                    <button
                        id="logoutBtn"
                        class="w-full flex items-center space-x-3 text-red-300 hover:text-red-200 transition-colors p-3 rounded-xl hover:bg-red-500/20 font-medium"
                    >
                        <i class="fas fa-sign-out-alt w-5"></i>
                        <span>Keluar</span>
                    </button>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="lg:ml-64 min-h-screen">
            <!-- Header -->
            <header class="glass-morphism p-4 sticky top-0 z-30">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-4">
                        <button class="text-white hover:text-gray-300 lg:hidden" id="openSidebar">
                            <i class="fas fa-bars text-xl"></i>
                        </button>
                        <h1 class="text-2xl font-bold text-white flex items-center space-x-2">
                            <i class="fas fa-piggy-bank coin-animation floating-animation"></i>
                            <span>Personal Savings</span>
                        </h1>
                    </div>

                    <div class="flex items-center space-x-4">
                        <button
                            class="action-button bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white px-4 py-2 rounded-xl transition-all duration-300 flex items-center space-x-2 font-medium"
                            id="addTransactionBtn"
                        >
                            <i class="fas fa-plus"></i>
                            <span class="hidden sm:inline">Transaksi</span>
                        </button>
                        <button class="text-white hover:text-gray-300 relative pulse-animation" id="notificationBtn">
                            <i class="fas fa-bell text-xl"></i>
                            <span
                                class="absolute -top-1 -right-1 bg-red-500 text-xs rounded-full w-5 h-5 flex items-center justify-center font-medium"
                                id="notificationCount"
                                >0</span
                            >
                        </button>
                    </div>
                </div>
            </header>

            <!-- Dashboard Section -->
            <section id="dashboard" class="p-6">
                <!-- Welcome Message -->
                <div class="data-card rounded-2xl p-6 mb-8">
                    <div class="flex items-center justify-between">
                        <div>
                            <h2 class="text-2xl font-bold text-white mb-2">Selamat Datang! ðŸ‘‹</h2>
                            <p class="text-white/80 font-medium" id="welcomeMessage">Mari kelola keuangan Anda dengan bijak</p>
                        </div>
                        <div class="hidden md:block">
                            <div
                                class="w-16 h-16 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full flex items-center justify-center floating-animation"
                            >
                                <i class="fas fa-star text-2xl text-white"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Stats Cards -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <!-- Total Saldo -->
                    <div class="data-card card-hover rounded-2xl p-6 text-white">
                        <div class="flex items-center justify-between mb-4">
                            <div>
                                <p class="text-sm opacity-80 font-medium">Total Saldo</p>
                                <p class="text-2xl font-bold" id="totalBalance">Rp 0</p>
                            </div>
                            <div
                                class="w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center floating-animation"
                                style="--delay: 0s;"
                            >
                                <i class="fas fa-wallet text-xl"></i>
                            </div>
                        </div>
                        <div class="w-full bg-white/20 rounded-full h-3">
                            <div
                                class="bg-gradient-to-r from-blue-500 to-blue-600 h-3 rounded-full transition-all duration-1000"
                                style="width: 70%"
                                id="balanceProgress"
                            ></div>
                        </div>
                    </div>

                    <!-- Dana Darurat -->
                    <div class="data-card card-hover rounded-2xl p-6 text-white">
                        <div class="flex items-center justify-between mb-4">
                            <div>
                                <p class="text-sm opacity-80 font-medium">Dana Darurat</p>
                                <p class="text-2xl font-bold" id="emergencyFund">Rp 0</p>
                            </div>
                            <div
                                class="w-12 h-12 bg-gradient-to-br from-yellow-500 to-orange-500 rounded-full flex items-center justify-center floating-animation"
                                style="--delay: 0.5s;"
                            >
                                <i class="fas fa-shield-alt text-xl"></i>
                            </div>
                        </div>
                        <div class="w-full bg-white/20 rounded-full h-3">
                            <div
                                class="bg-gradient-to-r from-yellow-500 to-orange-500 h-3 rounded-full transition-all duration-1000"
                                style="width: 45%"
                                id="emergencyProgress"
                            ></div>
                        </div>
                    </div>

                    <!-- Total Pengeluaran -->
                    <div class="data-card card-hover rounded-2xl p-6 text-white">
                        <div class="flex items-center justify-between mb-4">
                            <div>
                                <p class="text-sm opacity-80 font-medium">Total Pengeluaran</p>
                                <p class="text-2xl font-bold" id="totalExpenses">Rp 0</p>
                            </div>
                            <div
                                class="w-12 h-12 bg-gradient-to-br from-red-500 to-pink-500 rounded-full flex items-center justify-center floating-animation"
                                style="--delay: 1s;"
                            >
                                <i class="fas fa-arrow-down text-xl"></i>
                            </div>
                        </div>
                        <div class="w-full bg-white/20 rounded-full h-3">
                            <div
                                class="bg-gradient-to-r from-red-500 to-pink-500 h-3 rounded-full transition-all duration-1000"
                                style="width: 30%"
                                id="expenseProgress"
                            ></div>
                        </div>
                    </div>

                    <!-- Target Bulan Ini -->
                    <div class="data-card card-hover rounded-2xl p-6 text-white">
                        <div class="flex items-center justify-between mb-4">
                            <div>
                                <p class="text-sm opacity-80 font-medium">Target Bulan Ini</p>
                                <p class="text-2xl font-bold" id="monthlyTarget">Rp 1.000.000</p>
                            </div>
                            <div
                                class="w-12 h-12 bg-gradient-to-br from-green-500 to-emerald-500 rounded-full flex items-center justify-center floating-animation"
                                style="--delay: 1.5s;"
                            >
                                <i class="fas fa-bullseye text-xl"></i>
                            </div>
                        </div>
                        <div class="w-full bg-white/20 rounded-full h-3">
                            <div
                                class="bg-gradient-to-r from-green-500 to-emerald-500 h-3 rounded-full transition-all duration-1000"
                                style="width: 60%"
                                id="targetProgress"
                            ></div>
                        </div>
                    </div>
                </div>

                <!-- Charts Row -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                    <!-- Savings Chart -->
                    <div class="data-card rounded-2xl p-6">
                        <h3 class="text-white text-xl font-semibold mb-4">Trend Tabungan</h3>
                        <div class="chart-container">
                            <canvas id="savingsChart"></canvas>
                        </div>
                    </div>

                    <!-- Expense Breakdown -->
                    <div class="data-card rounded-2xl p-6">
                        <h3 class="text-white text-xl font-semibold mb-4">Distribusi Dana</h3>
                        <div class="chart-container">
                            <canvas id="distributionChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Recent Transactions -->
                <div class="data-card rounded-2xl p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-white text-xl font-semibold">Transaksi Terbaru</h3>
                        <button class="text-blue-300 hover:text-blue-200 transition-colors font-medium" id="viewAllTransactions">
                            Lihat Semua <i class="fas fa-arrow-right ml-1"></i>
                        </button>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-white">
                            <thead>
                                <tr class="border-b border-white/10">
                                    <th class="text-left py-3 px-2 font-semibold">Tanggal</th>
                                    <th class="text-left py-3 px-2 font-semibold">Keterangan</th>
                                    <th class="text-right py-3 px-2 font-semibold">Jumlah</th>
                                    <th class="text-center py-3 px-2 font-semibold">Tipe</th>
                                    <th class="text-center py-3 px-2 font-semibold">Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="recentTransactionsTable"></tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Transactions Section -->
            <section id="transactions" class="p-6 hidden">
                <div class="data-card rounded-2xl p-6">
                    <div
                        class="flex flex-col sm:flex-row items-start sm:items-center justify-between mb-6 space-y-4 sm:space-y-0"
                    >
                        <h2 class="text-2xl font-bold text-white">Semua Transaksi</h2>
                        <div class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4 w-full sm:w-auto">
                            <select
                                class="bg-white/10 text-white rounded-xl px-4 py-2 border border-white/20 font-medium"
                                id="filterType"
                            >
                                <option value="">Semua Tipe</option>
                                <option value="saving">Tabungan</option>
                                <option value="withdrawal">Pengambilan</option>
                                <option value="emergency">Dana Darurat</option>
                            </select>
                            <input
                                type="month"
                                class="bg-white/10 text-white rounded-xl px-4 py-2 border border-white/20 font-medium"
                                id="filterMonth"
                            />
                        </div>
                    </div>

                    <div class="overflow-x-auto">
                        <table class="w-full text-white">
                            <thead>
                                <tr class="border-b border-white/10">
                                    <th class="text-left py-3 px-2 font-semibold">Tanggal</th>
                                    <th class="text-left py-3 px-2 font-semibold">Keterangan</th>
                                    <th class="text-right py-3 px-2 font-semibold">Jumlah</th>
                                    <th class="text-center py-3 px-2 font-semibold">Tipe</th>
                                    <th class="text-center py-3 px-2 font-semibold">Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="allTransactionsTable"></tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Goals Section -->
            <section id="goals" class="p-6 hidden">
                <div class="data-card rounded-2xl p-6 mb-6">
                    <div class="flex items-center justify-between mb-6">
                        <h2 class="text-2xl font-bold text-white">Target Tabungan</h2>
                        <button
                            class="action-button bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white px-4 py-2 rounded-xl transition-all duration-300 font-medium"
                            id="addGoalBtn"
                        >
                            <i class="fas fa-plus mr-2"></i>Tambah Target
                        </button>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="goalsContainer"></div>
                </div>
            </section>

            <!-- Reports Section -->
            <section id="reports" class="p-6 hidden">
                <div class="data-card rounded-2xl p-6">
                    <h2 class="text-2xl font-bold text-white mb-6">Laporan Keuangan</h2>

                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Monthly Report -->
                        <div class="bg-white/5 rounded-xl p-6">
                            <h3 class="text-white text-lg font-semibold mb-4">Laporan Bulanan</h3>
                            <div class="chart-container">
                                <canvas id="monthlyReport"></canvas>
                            </div>
                        </div>

                        <!-- Yearly Comparison -->
                        <div class="bg-white/5 rounded-xl p-6">
                            <h3 class="text-white text-lg font-semibold mb-4">Perbandingan Tahunan</h3>
                            <div class="chart-container">
                                <canvas id="yearlyComparison"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Settings Section -->
            <section id="settings" class="p-6 hidden">
                <div class="space-y-6">
                    <!-- Profile Settings -->
                    <div class="settings-card rounded-2xl p-6">
                        <h3 class="text-white text-xl font-semibold mb-4 flex items-center">
                            <i class="fas fa-user-circle mr-3"></i>Profil Pengguna
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-white/90 mb-2 font-medium">Nama Lengkap</label>
                                <input
                                    type="text"
                                    id="fullName"
                                    class="w-full bg-white/10 text-white rounded-xl px-4 py-3 border border-white/20 focus:border-white focus:outline-none transition-all"
                                    placeholder="Masukkan nama lengkap"
                                />
                            </div>
                            <div>
                                <label class="block text-white/90 mb-2 font-medium">Email</label>
                                <input
                                    type="email"
                                    id="email"
                                    class="w-full bg-white/10 text-white rounded-xl px-4 py-3 border border-white/20 focus:border-white focus:outline-none transition-all"
                                    placeholder="Masukkan email"
                                />
                            </div>
                        </div>
                    </div>

                    <!-- Target Settings -->
                    <div class="settings-card rounded-2xl p-6">
                        <h3 class="text-white text-xl font-semibold mb-4 flex items-center">
                            <i class="fas fa-bullseye mr-3"></i>Target Tabungan
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-white/90 mb-2 font-medium">Target Bulanan (Rp)</label>
                                <input
                                    type="number"
                                    id="monthlyTargetSetting"
                                    class="w-full bg-white/10 text-white rounded-xl px-4 py-3 border border-white/20 focus:border-white focus:outline-none transition-all"
                                    placeholder="1000000"
                                    min="0"
                                    step="50000"
                                />
                            </div>
                            <div>
                                <label class="block text-white/90 mb-2 font-medium">Target Dana Darurat (Rp)</label>
                                <input
                                    type="number"
                                    id="emergencyTargetSetting"
                                    class="w-full bg-white/10 text-white rounded-xl px-4 py-3 border border-white/20 focus:border-white focus:outline-none transition-all"
                                    placeholder="5000000"
                                    min="0"
                                    step="100000"
                                />
                            </div>
                        </div>
                    </div>

                    <!-- Notification Settings -->
                    <div class="settings-card rounded-2xl p-6">
                        <h3 class="text-white text-xl font-semibold mb-4 flex items-center">
                            <i class="fas fa-bell mr-3"></i>Notifikasi
                        </h3>
                        <div class="space-y-4">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-white font-medium">Reminder Tabungan Harian</p>
                                    <p class="text-white/70 text-sm">Ingatkan untuk menabung setiap hari</p>
                                </div>
                                <button
                                    class="relative inline-flex h-6 w-11 items-center rounded-full bg-white/20 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"
                                    id="dailyReminderToggle"
                                >
                                    <span
                                        class="inline-block h-4 w-4 transform rounded-full bg-white transition-transform translate-x-1"
                                    ></span>
                                </button>
                            </div>
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-white font-medium">Alert Target Tercapai</p>
                                    <p class="text-white/70 text-sm">Notifikasi saat target tercapai</p>
                                </div>
                                <button
                                    class="relative inline-flex h-6 w-11 items-center rounded-full bg-blue-500 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"
                                    id="goalAlertToggle"
                                >
                                    <span
                                        class="inline-block h-4 w-4 transform rounded-full bg-white transition-transform translate-x-6"
                                    ></span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Security Settings -->
                    <div class="settings-card rounded-2xl p-6">
                        <h3 class="text-white text-xl font-semibold mb-4 flex items-center">
                            <i class="fas fa-shield-alt mr-3"></i>Keamanan
                        </h3>
                        <div class="space-y-4">
                            <button
                                class="w-full text-left bg-white/5 hover:bg-white/10 rounded-xl p-4 transition-all duration-300 border border-white/10"
                                id="changePINBtn"
                            >
                                <div class="flex items-center justify-between">
                                    <div>
                                        <p class="text-white font-medium">Ubah PIN</p>
                                        <p class="text-white/70 text-sm">Ganti PIN keamanan aplikasi</p>
                                    </div>
                                    <i class="fas fa-chevron-right text-white/70"></i>
                                </div>
                            </button>
                            <button
                                class="w-full text-left bg-white/5 hover:bg-white/10 rounded-xl p-4 transition-all duration-300 border border-white/10"
                                id="changePasswordBtn"
                            >
                                <div class="flex items-center justify-between">
                                    <div>
                                        <p class="text-white font-medium">Ubah Password</p>
                                        <p class="text-white/70 text-sm">Ganti password login</p>
                                    </div>
                                    <i class="fas fa-chevron-right text-white/70"></i>
                                </div>
                            </button>
                        </div>
                    </div>

                    <!-- Data Management -->
                    <div class="settings-card rounded-2xl p-6">
                        <h3 class="text-white text-xl font-semibold mb-4 flex items-center">
                            <i class="fas fa-database mr-3"></i>Manajemen Data
                        </h3>
                        <div class="space-y-4">
                            <button
                                class="w-full text-left bg-green-500/10 hover:bg-green-500/20 rounded-xl p-4 transition-all duration-300 border border-green-500/20"
                                id="exportDataBtn"
                            >
                                <div class="flex items-center justify-between">
                                    <div>
                                        <p class="text-green-300 font-medium">Export Data</p>
                                        <p class="text-green-300/70 text-sm">Unduh data transaksi sebagai JSON</p>
                                    </div>
                                    <i class="fas fa-download text-green-300"></i>
                                </div>
                            </button>
                            <button
                                class="w-full text-left bg-red-500/10 hover:bg-red-500/20 rounded-xl p-4 transition-all duration-300 border border-red-500/20"
                                id="clearDataBtn"
                            >
                                <div class="flex items-center justify-between">
                                    <div>
                                        <p class="text-red-300 font-medium">Hapus Semua Data</p>
                                        <p class="text-red-300/70 text-sm">Hapus semua transaksi dan target</p>
                                    </div>
                                    <i class="fas fa-trash text-red-300"></i>
                                </div>
                            </button>
                        </div>
                    </div>

                    <!-- Save Settings Button -->
                    <div class="text-center">
                        <button
                            class="action-button bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white px-8 py-3 rounded-xl transition-all duration-300 font-semibold"
                            id="saveSettingsBtn"
                        >
                            <i class="fas fa-save mr-2"></i>Simpan Pengaturan
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Transaction Modal -->
    <div
        class="modal fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"
        id="transactionModal"
        aria-hidden="true"
        role="dialog"
        aria-modal="true"
    >
        <div class="data-card rounded-2xl p-6 w-full max-w-md max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-white text-xl font-semibold" id="modalTitle">Tambah Transaksi</h3>
                <button class="text-white hover:text-gray-300" id="closeModal" aria-label="Tutup modal transaksi">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>

            <form id="transactionForm" class="space-y-4">
                <div>
                    <label class="block text-white mb-2 font-medium" for="transactionType">Tipe Transaksi</label>
                    <select
                        class="w-full bg-white/10 text-white rounded-xl px-4 py-3 border border-white/20 font-medium"
                        id="transactionType"
                        required
                    >
                        <option value="">Pilih Tipe</option>
                        <option value="saving">Tabungan</option>
                        <option value="withdrawal">Pengambilan</option>
                        <option value="emergency">Dana Darurat</option>
                    </select>
                </div>

                <div>
                    <label class="block text-white mb-2 font-medium" for="transactionDate">Tanggal</label>
                    <input
                        type="date"
                        class="w-full bg-white/10 text-white rounded-xl px-4 py-3 border border-white/20 font-medium"
                        id="transactionDate"
                        required
                    />
                </div>

                <div>
                    <label class="block text-white mb-2 font-medium" for="transactionAmount">Jumlah (Rp)</label>
                    <input
                        type="number"
                        class="w-full bg-white/10 text-white rounded-xl px-4 py-3 border border-white/20 font-medium"
                        id="transactionAmount"
                        min="1"
                        step="1000"
                        required
                    />
                </div>

                <div>
                    <label class="block text-white mb-2 font-medium" for="transactionNote">Keterangan</label>
                    <input
                        type="text"
                        class="w-full bg-white/10 text-white rounded-xl px-4 py-3 border border-white/20 font-medium"
                        id="transactionNote"
                        maxlength="100"
                        placeholder="Opsional"
                    />
                </div>

                <div class="flex space-x-4 pt-4">
                    <button
                        type="button"
                        class="flex-1 bg-gray-500 hover:bg-gray-600 text-white py-3 rounded-xl transition-colors font-medium"
                        id="cancelTransaction"
                    >
                        Batal
                    </button>
                    <button
                        type="submit"
                        class="flex-1 action-button bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white py-3 rounded-xl transition-all duration-300 flex items-center justify-center font-semibold"
                    >
                        <span id="submitText">Simpan</span>
                        <div class="loading-spinner ml-2 hidden" id="submitLoader"></div>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Goal Modal -->
    <div
        class="modal fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"
        id="goalModal"
        aria-hidden="true"
        role="dialog"
        aria-modal="true"
    >
        <div class="data-card rounded-2xl p-6 w-full max-w-md max-h-[90vh] overflow-y-auto">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-white text-xl font-semibold" id="goalModalTitle">Tambah Target</h3>
                <button class="text-white hover:text-gray-300" id="closeGoalModal" aria-label="Tutup modal target">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>

            <form id="goalForm" class="space-y-4">
                <div>
                    <label class="block text-white mb-2 font-medium" for="goalName">Nama Target</label>
                    <input
                        type="text"
                        class="w-full bg-white/10 text-white rounded-xl px-4 py-3 border border-white/20 font-medium"
                        id="goalName"
                        required
                        placeholder="Contoh: Beli Motor"
                    />
                </div>

                <div>
                    <label class="block text-white mb-2 font-medium" for="goalAmount">Target Jumlah (Rp)</label>
                    <input
                        type="number"
                        class="w-full bg-white/10 text-white rounded-xl px-4 py-3 border border-white/20 font-medium"
                        id="goalAmount"
                        min="1"
                        step="10000"
                        required
                    />
                </div>

                <div>
                    <label class="block text-white mb-2 font-medium" for="goalDate">Target Tanggal</label>
                    <input
                        type="date"
                        class="w-full bg-white/10 text-white rounded-xl px-4 py-3 border border-white/20 font-medium"
                        id="goalDate"
                        required
                    />
                </div>

                <div>
                    <label class="block text-white mb-2 font-medium" for="goalDescription">Deskripsi</label>
                    <textarea
                        class="w-full bg-white/10 text-white rounded-xl px-4 py-3 border border-white/20 font-medium h-20 resize-none"
                        id="goalDescription"
                        maxlength="200"
                        placeholder="Opsional"
                    ></textarea>
                </div>

                <div class="flex space-x-4 pt-4">
                    <button
                        type="button"
                        class="flex-1 bg-gray-500 hover:bg-gray-600 text-white py-3 rounded-xl transition-colors font-medium"
                        id="cancelGoal"
                    >
                        Batal
                    </button>
                    <button
                        type="submit"
                        class="flex-1 action-button bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white py-3 rounded-xl transition-all duration-300 flex items-center justify-center font-semibold"
                    >
                        <span id="goalSubmitText">Simpan</span>
                        <div class="loading-spinner ml-2 hidden" id="goalSubmitLoader"></div>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Notification -->
    <div
        class="notification fixed top-4 right-4 z-50 bg-green-500 text-white px-6 py-3 rounded-xl shadow-lg max-w-sm"
        id="notification"
        role="alert"
        aria-live="assertive"
        aria-atomic="true"
    >
        <div class="flex items-center space-x-2">
            <i class="fas fa-check-circle"></i>
            <span id="notificationText" class="font-medium">Berhasil!</span>
        </div>
    </div>

    <script>
        // Data and state
        let savings = [
        ];

        let goals = [
            
        ];

        let userSettings = {
            monthlyTarget: 1000000,
            emergencyTarget: 5000000,
            dailyReminder: false,
            goalAlert: true
        };

        let currentUser = null;
        let editingId = null;
        let editingType = null;

        const app = {
            isLoggedIn: false,
            currentSection: 'dashboard',
            charts: {
                savings: null,
                distribution: null,
                monthly: null,
                yearly: null
            }
        };

        // Utils
        const utils = {
            formatRupiah: (number) => {
                if (typeof number !== 'number') number = Number(number) || 0;
                return number.toLocaleString('id-ID', { style: 'currency', currency: 'IDR' });
            },
            formatDate: (dateStr) => {
                const d = new Date(dateStr);
                if (isNaN(d)) return '-';
                return d.toLocaleDateString('id-ID', { day: '2-digit', month: 'short', year: 'numeric' });
            },
            showNotification: (message, type = 'success') => {
                const notification = document.getElementById('notification');
                const notificationText = document.getElementById('notificationText');
                notificationText.textContent = message;
                notification.classList.remove('bg-green-500', 'bg-red-500');
                if (type === 'error') {
                    notification.classList.add('bg-red-500');
                } else {
                    notification.classList.add('bg-green-500');
                }
                notification.classList.add('show');
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 3000);
            }
        };

        // Data Manager
        const dataManager = {
            getStats: () => {
                let totalBalance = 0;
                let emergencyFund = 0;
                let totalExpenses = 0;

                savings.forEach((item) => {
                    if (item.type === 'saving') totalBalance += item.amount;
                    else if (item.type === 'withdrawal') totalBalance -= item.amount;
                    else if (item.type === 'emergency') emergencyFund += item.amount;
                });

                savings.forEach((item) => {
                    if (item.type === 'withdrawal') totalExpenses += item.amount;
                });

                return {
                    totalBalance,
                    emergencyFund,
                    totalExpenses
                };
            }
        };

        // Modal management
        const modal = {
            show: (modalId) => {
                const modalElement = document.getElementById(modalId);
                if (modalElement) {
                    modalElement.classList.add('active');
                    document.body.style.overflow = 'hidden';
                    modalElement.setAttribute('aria-hidden', 'false');
                }
            },

            hide: (modalId) => {
                const modalElement = document.getElementById(modalId);
                if (modalElement) {
                    modalElement.classList.remove('active');
                    document.body.style.overflow = 'auto';
                    modalElement.setAttribute('aria-hidden', 'true');
                }
            },

            showTransactionModal: (id = null) => {
                const modalTitle = document.getElementById('modalTitle');
                const form = document.getElementById('transactionForm');

                if (id) {
                    // Edit mode
                    const transaction = savings.find((s) => s.id === id);
                    if (transaction) {
                        modalTitle.textContent = 'Edit Transaksi';
                        document.getElementById('transactionType').value = transaction.type;
                        document.getElementById('transactionDate').value = transaction.date;
                        document.getElementById('transactionAmount').value = transaction.amount;
                        document.getElementById('transactionNote').value = transaction.note || '';
                        editingId = id;
                    }
                } else {
                    // Add mode
                    modalTitle.textContent = 'Tambah Transaksi';
                    form.reset();
                    editingId = null;
                }

                // Set max date to today
                const today = new Date().toISOString().split('T')[0];
                document.getElementById('transactionDate').setAttribute('max', today);

                modal.show('transactionModal');
            },

            showGoalModal: (id = null) => {
                const modalTitle = document.getElementById('goalModalTitle');
                const form = document.getElementById('goalForm');

                if (id) {
                    // Edit mode
                    const goal = goals.find((g) => g.id === id);
                    if (goal) {
                        modalTitle.textContent = 'Edit Target';
                        document.getElementById('goalName').value = goal.name;
                        document.getElementById('goalAmount').value = goal.amount;
                        document.getElementById('goalDate').value = goal.date;
                        document.getElementById('goalDescription').value = goal.description || '';
                        editingId = id;
                        editingType = 'goal';
                    }
                } else {
                    // Add mode
                    modalTitle.textContent = 'Tambah Target';
                    form.reset();
                    editingId = null;
                    editingType = null;
                }

                // Set min date to today
                const today = new Date().toISOString().split('T')[0];
                document.getElementById('goalDate').setAttribute('min', today);

                modal.show('goalModal');
            }
        };

        // UI management
        const ui = {
            updateStats: () => {
                const stats = dataManager.getStats();

                document.getElementById('totalBalance').textContent = utils.formatRupiah(stats.totalBalance);
                document.getElementById('emergencyFund').textContent = utils.formatRupiah(stats.emergencyFund);
                document.getElementById('totalExpenses').textContent = utils.formatRupiah(stats.totalExpenses);
                document.getElementById('monthlyTarget').textContent = utils.formatRupiah(userSettings.monthlyTarget);

                // Update progress bars with animation
                const updateProgressBar = (id, percentage) => {
                    const element = document.getElementById(id);
                    if (element) {
                        element.style.width = `${percentage}%`;
                    }
                };

                updateProgressBar('balanceProgress', Math.min((stats.totalBalance / 10000000) * 100, 100));
                updateProgressBar('emergencyProgress', Math.min((stats.emergencyFund / userSettings.emergencyTarget) * 100, 100));
                updateProgressBar('expenseProgress', Math.min((stats.totalExpenses / 5000000) * 100, 100));
                updateProgressBar('targetProgress', Math.min((stats.totalBalance / userSettings.monthlyTarget) * 100, 100));
            },

            updateGoals: () => {
                const container = document.getElementById('goalsContainer');
                if (!container) return;

                if (goals.length === 0) {
                    container.innerHTML = `
                        <div class="col-span-full text-center py-12">
                            <i class="fas fa-bullseye text-6xl text-white/30 mb-4"></i>
                            <p class="text-white/60 text-lg font-medium">Belum ada target tabungan</p>
                            <p class="text-white/50 text-sm">Buat target pertama Anda!</p>
                        </div>
                    `;
                    return;
                }

                container.innerHTML = goals
                    .map((goal) => {
                        const progress = Math.min((goal.currentAmount / goal.amount) * 100, 100);
                        const daysLeft = Math.ceil((new Date(goal.date) - new Date()) / (1000 * 60 * 60 * 24));
                        const isOverdue = daysLeft < 0;
                        const isCompleted = goal.isCompleted || progress === 100;

                        return `
                        <div class="goal-card rounded-2xl p-6">
                            <div class="flex items-start justify-between mb-4">
                                <div class="flex-1">
                                    <h4 class="text-white font-semibold text-lg mb-1">${goal.name}</h4>
                                    <p class="text-white/70 text-sm">${goal.description || ''}</p>
                                </div>
                                <div class="flex space-x-2">
                                    <button onclick="editGoal('${goal.id}')" class="text-blue-400 hover:text-blue-300 p-1" aria-label="Edit target ${goal.name}">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button onclick="deleteGoal('${goal.id}')" class="text-red-400 hover:text-red-300 p-1" aria-label="Hapus target ${goal.name}">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>

                            <div class="mb-4">
                                <div class="flex justify-between text-sm mb-2">
                                    <span class="text-white/80">Progress</span>
                                    <span class="text-white font-semibold">${progress.toFixed(1)}%</span>
                                </div>
                                <div class="w-full bg-white/20 rounded-full h-3">
                                    <div class="bg-gradient-to-r from-green-500 to-emerald-500 h-3 rounded-full transition-all duration-1000" style="width: ${progress}%"></div>
                                </div>
                            </div>

                            <div class="flex justify-between items-center text-sm mb-4">
                                <span class="text-white/80">${utils.formatRupiah(goal.currentAmount)} / ${utils.formatRupiah(goal.amount)}</span>
                                <span class="text-white/60">${utils.formatDate(goal.date)}</span>
                            </div>

                            <div class="flex justify-between items-center">
                                <span class="text-sm ${
                                    isOverdue ? 'text-red-400' : isCompleted ? 'text-green-400' : 'text-yellow-400'
                                }">
                                    ${isCompleted ? 'âœ… Selesai' : isOverdue ? `â° Terlambat ${Math.abs(daysLeft)} hari` : `â³ ${daysLeft} hari lagi`}
                                </span>
                                <button onclick="addProgressToGoal('${goal.id}')" class="text-xs bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded-full transition-colors" aria-label="Tambah progress target ${goal.name}">
                                    + Progress
                                </button>
                            </div>
                        </div>
                    `;
                    })
                    .join('');
            },

            updateCharts: () => {
                if (typeof Chart === 'undefined') {
                    setTimeout(() => ui.updateCharts(), 500);
                    return;
                }
                ui.updateSavingsChart();
                ui.updateDistributionChart();
                ui.updateMonthlyReport();
                ui.updateYearlyComparison();
            },

            updateSavingsChart: () => {
                if (typeof Chart === 'undefined') return;

                const ctx = document.getElementById('savingsChart');
                if (!ctx) return;

                const chartCtx = ctx.getContext('2d');

                // Get last 6 months data
                const last6Months = [];
                const today = new Date();

                for (let i = 5; i >= 0; i--) {
                    const date = new Date(today.getFullYear(), today.getMonth() - i, 1);
                    const monthStr = date.toISOString().slice(0, 7);

                    let monthlyTotal = 0;
                    savings.forEach((item) => {
                        const itemMonth = item.date.slice(0, 7);
                        if (itemMonth === monthStr) {
                            if (item.type === 'saving') monthlyTotal += item.amount;
                            else if (item.type === 'withdrawal') monthlyTotal -= item.amount;
                        }
                    });

                    last6Months.push({
                        month: date.toLocaleDateString('id-ID', { month: 'short' }),
                        amount: monthlyTotal
                    });
                }

                if (app.charts.savings) {
                    app.charts.savings.destroy();
                }

                app.charts.savings = new Chart(chartCtx, {
                    type: 'line',
                    data: {
                        labels: last6Months.map((m) => m.month),
                        datasets: [
                            {
                                label: 'Tabungan',
                                data: last6Months.map((m) => m.amount),
                                borderColor: '#3B82F6',
                                backgroundColor: 'rgba(59, 130, 246, 0.1)',
                                borderWidth: 3,
                                fill: true,
                                tension: 0.4
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                labels: {
                                    color: '#ffffff'
                                }
                            }
                        },
                        scales: {
                            x: {
                                ticks: {
                                    color: '#ffffff'
                                },
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                }
                            },
                            y: {
                                ticks: {
                                    color: '#ffffff',
                                    callback: function (value) {
                                        return utils.formatRupiah(value);
                                    }
                                },
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                }
                            }
                        }
                    }
                });
            },

            updateDistributionChart: () => {
                if (typeof Chart === 'undefined') return;

                const ctx = document.getElementById('distributionChart');
                if (!ctx) return;

                const chartCtx = ctx.getContext('2d');
                const stats = dataManager.getStats();

                if (app.charts.distribution) {
                    app.charts.distribution.destroy();
                }

                app.charts.distribution = new Chart(chartCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Tabungan', 'Dana Darurat', 'Pengeluaran'],
                        datasets: [
                            {
                                data: [stats.totalBalance, stats.emergencyFund, stats.totalExpenses],
                                backgroundColor: ['#3B82F6', '#F59E0B', '#EF4444'],
                                borderColor: ['#1D4ED8', '#D97706', '#DC2626'],
                                borderWidth: 2
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    color: '#ffffff',
                                    padding: 20
                                }
                            }
                        }
                    }
                });
            },

            updateMonthlyReport: () => {
                if (typeof Chart === 'undefined') return;

                const ctx = document.getElementById('monthlyReport');
                if (!ctx) return;

                const ctxChart = ctx.getContext('2d');

                if (app.charts.monthly) {
                    app.charts.monthly.destroy();
                }

                // Get current month data by type
                const currentMonth = new Date().toISOString().slice(0, 7);
                const monthlyData = {
                    saving: 0,
                    withdrawal: 0,
                    emergency: 0
                };

                savings.forEach((item) => {
                    if (item.date.slice(0, 7) === currentMonth) {
                        monthlyData[item.type] += item.amount;
                    }
                });

                app.charts.monthly = new Chart(ctxChart, {
                    type: 'bar',
                    data: {
                        labels: ['Tabungan', 'Pengambilan', 'Dana Darurat'],
                        datasets: [
                            {
                                label: 'Bulan Ini',
                                data: [monthlyData.saving, monthlyData.withdrawal, monthlyData.emergency],
                                backgroundColor: ['#3B82F6', '#EF4444', '#F59E0B'],
                                borderColor: ['#1D4ED8', '#DC2626', '#D97706'],
                                borderWidth: 2
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                labels: {
                                    color: '#ffffff'
                                }
                            }
                        },
                        scales: {
                            x: {
                                ticks: {
                                    color: '#ffffff'
                                },
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                }
                            },
                            y: {
                                ticks: {
                                    color: '#ffffff',
                                    callback: function (value) {
                                        return utils.formatRupiah(value);
                                    }
                                },
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                }
                            }
                        }
                    }
                });
            },

            updateYearlyComparison: () => {
                if (typeof Chart === 'undefined') return;

                const ctx = document.getElementById('yearlyComparison');
                if (!ctx) return;

                const ctxChart = ctx.getContext('2d');

                if (app.charts.yearly) {
                    app.charts.yearly.destroy();
                }

                // Get last 2 years data
                const currentYear = new Date().getFullYear();
                const lastYear = currentYear - 1;

                const yearlyData = {
                    [currentYear]: 0,
                    [lastYear]: 0
                };

                savings.forEach((item) => {
                    const itemYear = new Date(item.date).getFullYear();
                    if (yearlyData.hasOwnProperty(itemYear)) {
                        if (item.type === 'saving') {
                            yearlyData[itemYear] += item.amount;
                        } else if (item.type === 'withdrawal') {
                            yearlyData[itemYear] -= item.amount;
                        }
                    }
                });

                app.charts.yearly = new Chart(ctxChart, {
                    type: 'bar',
                    data: {
                        labels: [lastYear.toString(), currentYear.toString()],
                        datasets: [
                            {
                                label: 'Total Tabungan',
                                data: [yearlyData[lastYear], yearlyData[currentYear]],
                                backgroundColor: ['#8B5CF6', '#3B82F6'],
                                borderColor: ['#7C3AED', '#1D4ED8'],
                                borderWidth: 2
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                labels: {
                                    color: '#ffffff'
                                }
                            }
                        },
                        scales: {
                            x: {
                                ticks: {
                                    color: '#ffffff'
                                },
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                }
                            },
                            y: {
                                ticks: {
                                    color: '#ffffff',
                                    callback: function (value) {
                                        return utils.formatRupiah(value);
                                    }
                                },
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)'
                                }
                            }
                        }
                    }
                });
            },

            updateTransactionsTable: (containerId, limit = null) => {
                const container = document.getElementById(containerId);
                if (!container) return;

                let displaySavings = [...savings].sort((a, b) => new Date(b.date) - new Date(a.date));

                // Apply filters for all transactions table
                if (containerId === 'allTransactionsTable') {
                    const filterType = document.getElementById('filterType');
                    const filterMonth = document.getElementById('filterMonth');

                    if (filterType && filterType.value) {
                        displaySavings = displaySavings.filter((s) => s.type === filterType.value);
                    }

                    if (filterMonth && filterMonth.value) {
                        displaySavings = displaySavings.filter((s) => s.date.slice(0, 7) === filterMonth.value);
                    }
                }

                if (limit) {
                    displaySavings = displaySavings.slice(0, limit);
                }

                if (displaySavings.length === 0) {
                    container.innerHTML = `
                        <tr>
                            <td colspan="5" class="text-center py-8 text-white/60 italic">
                                Belum ada transaksi
                            </td>
                        </tr>
                    `;
                    return;
                }

                container.innerHTML = displaySavings
                    .map((item) => {
                        const typeInfo = {
                            saving: { label: 'Tabungan', color: 'text-blue-400', icon: 'fa-arrow-up' },
                            withdrawal: { label: 'Pengambilan', color: 'text-red-400', icon: 'fa-arrow-down' },
                            emergency: { label: 'Dana Darurat', color: 'text-yellow-400', icon: 'fa-shield-alt' }
                        };

                        const info = typeInfo[item.type] || typeInfo.saving;

                        return `
                        <tr class="border-b border-white/10 hover:bg-white/5 transition-colors">
                            <td class="py-3 px-2 text-white/80">${utils.formatDate(item.date)}</td>
                            <td class="py-3 px-2 text-white/90 max-w-xs truncate" title="${item.note || ''}">${item.note || '-'}</td>
                            <td class="py-3 px-2 text-right font-semibold ${info.color}">
                                ${item.type === 'withdrawal' ? '- ' : ''}${utils.formatRupiah(item.amount)}
                            </td>
                            <td class="py-3 px-2 text-center">
                                <span class="inline-flex items-center space-x-1 ${info.color}">
                                    <i class="fas ${info.icon}"></i>
                                    <span class="text-sm">${info.label}</span>
                                </span>
                            </td>
                            <td class="py-3 px-2 text-center">
                                <div class="flex items-center justify-center space-x-2">
                                    <button onclick="editTransaction('${item.id}')" class="text-blue-400 hover:text-blue-300 transition-colors p-1" aria-label="Edit transaksi tanggal ${utils.formatDate(item.date)}">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button onclick="deleteTransaction('${item.id}')" class="text-red-400 hover:text-red-300 transition-colors p-1" aria-label="Hapus transaksi tanggal ${utils.formatDate(item.date)}">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    `;
                    })
                    .join('');
            },

            updateAll: () => {
                ui.updateStats();
                ui.updateCharts();
                ui.updateTransactionsTable('recentTransactionsTable', 5);
                ui.updateTransactionsTable('allTransactionsTable');
                ui.updateGoals();
            },

            showSection: (sectionId) => {
                // Hide all sections
                document.querySelectorAll('main > section').forEach((section) => {
                    section.classList.add('hidden');
                });

                // Show target section
                const targetSection = document.getElementById(sectionId);
                if (targetSection) {
                    targetSection.classList.remove('hidden');
                    app.currentSection = sectionId;

                    // Animate section entrance
                    if (typeof gsap !== 'undefined') {
                        gsap.fromTo(
                            targetSection,
                            { opacity: 0, y: 20 },
                            { opacity: 1, y: 0, duration: 0.5 }
                        );
                    }

                    // Update charts if needed
                    if (sectionId === 'dashboard' || sectionId === 'reports') {
                        setTimeout(() => {
                            if (typeof Chart !== 'undefined') {
                                ui.updateCharts();
                            }
                        }, 100);
                    }
                }
            }
        };

        // Auth simulation
        const auth = {
            login: (username, password) => {
                // Demo: username: srydesi12, password: fokusnabung123
                return username === 'srydesi12' && password === 'fokusnabung123';
            },
            loginWithPIN: (pin) => {
                // Demo PIN: 050824
                return pin === '050824';
            },
            resetPINInputs: () => {
                document.querySelectorAll('.pin-input').forEach((input) => (input.value = ''));
                document.querySelectorAll('.pin-input')[0].focus();
            },
            logout: () => {
                currentUser = null;
                app.isLoggedIn = false;
                document.getElementById('loginScreen').classList.remove('hidden');
                document.getElementById('mainApp').classList.add('hidden');
                ui.showSection('dashboard');
            }
        };

        // Event handlers
        const events = {
            init: () => {
                events.initLogin();
                events.initMobileMenu();
                events.initNavigation();
                events.initTransactions();
                events.initGoals();
                events.initSettings();
                events.initFilters();
                events.initScroll();
                events.initWindow();
            },

            initLogin: () => {
                document.getElementById('loginModeUser').addEventListener('click', () => {
                    document.getElementById('loginModeUser').classList.add('bg-white/20');
                    document.getElementById('loginModeUser').classList.remove('text-white/70');
                    document.getElementById('loginModePIN').classList.remove('bg-white/20');
                    document.getElementById('loginModePIN').classList.add('text-white/70');
                    document.getElementById('userLoginForm').classList.remove('hidden');
                    document.getElementById('pinLoginForm').classList.add('hidden');
                });

                document.getElementById('loginModePIN').addEventListener('click', () => {
                    document.getElementById('loginModePIN').classList.add('bg-white/20');
                    document.getElementById('loginModePIN').classList.remove('text-white/70');
                    document.getElementById('loginModeUser').classList.remove('bg-white/20');
                    document.getElementById('loginModeUser').classList.add('text-white/70');
                    document.getElementById('pinLoginForm').classList.remove('hidden');
                    document.getElementById('userLoginForm').classList.add('hidden');
                    auth.resetPINInputs();
                });

                document.getElementById('userLoginForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    const username = document.getElementById('username').value;
                    const password = document.getElementById('password').value;

                    if (auth.login(username, password)) {
                        currentUser = username;
                        app.isLoggedIn = true;
                        document.getElementById('loginScreen').classList.add('hidden');
                        document.getElementById('mainApp').classList.remove('hidden');
                        document.getElementById('welcomeMessage').textContent = `Selamat datang kembali, ${username}!`;
                        utils.showNotification('Login berhasil!');
                        ui.updateAll();
                    } else {
                        utils.showNotification('Username atau password salah!', 'error');
                    }
                });

                document.getElementById('pinLoginForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    const pinInputs = document.querySelectorAll('.pin-input');
                    const pin = Array.from(pinInputs)
                        .map((input) => input.value)
                        .join('');

                    if (auth.loginWithPIN(pin)) {
                        currentUser = 'PIN User';
                        app.isLoggedIn = true;
                        document.getElementById('loginScreen').classList.add('hidden');
                        document.getElementById('mainApp').classList.remove('hidden');
                        document.getElementById('welcomeMessage').textContent = `Selamat datang kembali, ${currentUser}!`;
                        utils.showNotification('Login berhasil!');
                        ui.updateAll();
                    } else {
                        utils.showNotification('PIN salah!', 'error');
                        auth.resetPINInputs();
                    }
                });

                const pinInputs = document.querySelectorAll('.pin-input');
                pinInputs.forEach((input, index) => {
                    input.addEventListener('input', (e) => {
                        if (e.target.value && index < pinInputs.length - 1) {
                            pinInputs[index + 1].focus();
                        }
                    });

                    input.addEventListener('keydown', (e) => {
                        if (e.key === 'Backspace' && !e.target.value && index > 0) {
                            pinInputs[index - 1].focus();
                        }
                    });
                });

                document.getElementById('logoutBtn').addEventListener('click', () => {
                    if (confirm('Yakin ingin keluar?')) {
                        auth.logout();
                        utils.showNotification('Berhasil keluar');
                    }
                });
            },

            initMobileMenu: () => {
                document.getElementById('openSidebar').addEventListener('click', () => {
                    document.getElementById('sidebar').classList.add('active');
                    document.getElementById('mobileOverlay').classList.add('active');
                });

                document.getElementById('closeSidebar').addEventListener('click', () => {
                    document.getElementById('sidebar').classList.remove('active');
                    document.getElementById('mobileOverlay').classList.remove('active');
                });

                document.getElementById('mobileOverlay').addEventListener('click', () => {
                    document.getElementById('sidebar').classList.remove('active');
                    document.getElementById('mobileOverlay').classList.remove('active');
                });
            },

            initNavigation: () => {
                document.querySelectorAll('nav a[href^="#"]').forEach((link) => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        const sectionId = link.getAttribute('href').substring(1);
                        ui.showSection(sectionId);

                        // Close mobile menu
                        document.getElementById('sidebar').classList.remove('active');
                        document.getElementById('mobileOverlay').classList.remove('active');
                    });
                });

                // View all transactions button
                document.getElementById('viewAllTransactions').addEventListener('click', () => {
                    ui.showSection('transactions');
                });
            },

            initTransactions: () => {
                document.getElementById('addTransactionBtn').addEventListener('click', () => {
                    modal.showTransactionModal();
                });

                document.getElementById('closeModal').addEventListener('click', () => {
                    modal.hide('transactionModal');
                });

                document.getElementById('cancelTransaction').addEventListener('click', () => {
                    modal.hide('transactionModal');
                });

                document.getElementById('transactionForm').addEventListener('submit', (e) => {
                    e.preventDefault();

                    const submitBtn = e.target.querySelector('button[type="submit"]');
                    const submitText = document.getElementById('submitText');
                    const submitLoader = document.getElementById('submitLoader');

                    submitText.textContent = 'Menyimpan...';
                    submitLoader.classList.remove('hidden');
                    submitBtn.disabled = true;

                    setTimeout(() => {
                        const type = document.getElementById('transactionType').value;
                        const date = document.getElementById('transactionDate').value;
                        const rawAmount = document.getElementById('transactionAmount').value.trim().replace(/\D/g, '');
const amount = parseInt(rawAmount || '0');

                        const note = document.getElementById('transactionNote').value.trim();

                        if (!type || !date || !amount || amount <= 0) {
                            utils.showNotification('Mohon isi data dengan benar!', 'error');
                            submitText.textContent = 'Simpan';
                            submitLoader.classList.add('hidden');
                            submitBtn.disabled = false;
                            return;
                        }

                        if (editingId) {
                            // Edit existing
                            const idx = savings.findIndex((s) => s.id === editingId);
                            if (idx !== -1) {
                                savings[idx] = { id: editingId, type, date, amount, note };
                                utils.showNotification('Transaksi berhasil diperbarui!');
                            }
                        } else {
                            // Add new
                            const newId = 't' + (savings.length + 1) + '-' + Date.now();
                            savings.push({ id: newId, type, date, amount, note });
                            utils.showNotification('Transaksi berhasil ditambahkan!');
                        }

                        editingId = null;
                        modal.hide('transactionModal');
                        ui.updateAll();

                        submitText.textContent = 'Simpan';
                        submitLoader.classList.add('hidden');
                        submitBtn.disabled = false;
                    }, 800);
                });
            },

            initGoals: () => {
                document.getElementById('addGoalBtn').addEventListener('click', () => {
                    modal.showGoalModal();
                });

                document.getElementById('closeGoalModal').addEventListener('click', () => {
                    modal.hide('goalModal');
                });

                document.getElementById('cancelGoal').addEventListener('click', () => {
                    modal.hide('goalModal');
                });

                document.getElementById('goalForm').addEventListener('submit', (e) => {
                    e.preventDefault();

                    const submitBtn = e.target.querySelector('button[type="submit"]');
                    const submitText = document.getElementById('goalSubmitText');
                    const submitLoader = document.getElementById('goalSubmitLoader');

                    submitText.textContent = 'Menyimpan...';
                    submitLoader.classList.remove('hidden');
                    submitBtn.disabled = true;

                    setTimeout(() => {
                        const name = document.getElementById('goalName').value.trim();
                        const rawAmount = document.getElementById('goalAmount').value.trim().replace(/\D/g, '');
const amount = parseInt(rawAmount || '0', 10);

                        const date = document.getElementById('goalDate').value;
                        const description = document.getElementById('goalDescription').value.trim();

                        if (!name || isNaN(amount) || amount <= 0 || !date) {
    utils.showNotification('Mohon isi data dengan benar!', 'error');
    submitText.textContent = 'Simpan';
    submitLoader.classList.add('hidden');
    submitBtn.disabled = false;
    return;
}


                        if (editingId && editingType === 'goal') {
                            const idx = goals.findIndex((g) => g.id === editingId);
                            if (idx !== -1) {
                                goals[idx].name = name;
                                goals[idx].amount = amount;
                                goals[idx].date = date;
                                goals[idx].description = description;
                                utils.showNotification('Target berhasil diperbarui!');
                            }
                        } else {
                            const newId = 'g' + (goals.length + 1) + '-' + Date.now();
                            goals.push({
                                id: newId,
                                name,
                                amount,
                                currentAmount: 0,
                                date,
                                description,
                                isCompleted: false
                            });
                            utils.showNotification('Target berhasil ditambahkan!');
                        }

                        editingId = null;
                        editingType = null;
                        modal.hide('goalModal');
                        ui.updateGoals();

                        submitText.textContent = 'Simpan';
                        submitLoader.classList.add('hidden');
                        submitBtn.disabled = false;
                    }, 800);
                });
            },

            initSettings: () => {
                // Load settings to inputs
                const monthlyInput = document.getElementById('monthlyTargetSetting');
                const emergencyInput = document.getElementById('emergencyTargetSetting');
                const dailyToggle = document.getElementById('dailyReminderToggle');
                const goalToggle = document.getElementById('goalAlertToggle');

                monthlyInput.value = userSettings.monthlyTarget;
                emergencyInput.value = userSettings.emergencyTarget;

                if (userSettings.dailyReminder) {
                    dailyToggle.classList.add('bg-blue-500');
                    dailyToggle.querySelector('span').classList.add('translate-x-6');
                    dailyToggle.querySelector('span').classList.remove('translate-x-1');
                } else {
                    dailyToggle.classList.remove('bg-blue-500');
                    dailyToggle.querySelector('span').classList.remove('translate-x-6');
                    dailyToggle.querySelector('span').classList.add('translate-x-1');
                }

                if (userSettings.goalAlert) {
                    goalToggle.classList.add('bg-blue-500');
                    goalToggle.querySelector('span').classList.add('translate-x-6');
                    goalToggle.querySelector('span').classList.remove('translate-x-1');
                } else {
                    goalToggle.classList.remove('bg-blue-500');
                    goalToggle.querySelector('span').classList.remove('translate-x-6');
                    goalToggle.querySelector('span').classList.add('translate-x-1');
                }

                dailyToggle.addEventListener('click', () => {
                    userSettings.dailyReminder = !userSettings.dailyReminder;
                    dailyToggle.classList.toggle('bg-blue-500');
                    dailyToggle.querySelector('span').classList.toggle('translate-x-6');
                    dailyToggle.querySelector('span').classList.toggle('translate-x-1');
                });

                goalToggle.addEventListener('click', () => {
                    userSettings.goalAlert = !userSettings.goalAlert;
                    goalToggle.classList.toggle('bg-blue-500');
                    goalToggle.querySelector('span').classList.toggle('translate-x-6');
                    goalToggle.querySelector('span').classList.toggle('translate-x-1');
                });

                document.getElementById('saveSettingsBtn').addEventListener('click', () => {
                    const monthlyVal = parseInt(monthlyInput.value);
                    const emergencyVal = parseInt(emergencyInput.value);

                    if (isNaN(monthlyVal) || monthlyVal < 0) {
                        utils.showNotification('Target bulanan tidak valid', 'error');
                        return;
                    }
                    if (isNaN(emergencyVal) || emergencyVal < 0) {
                        utils.showNotification('Target dana darurat tidak valid', 'error');
                        return;
                    }

                    userSettings.monthlyTarget = monthlyVal;
                    userSettings.emergencyTarget = emergencyVal;

                    utils.showNotification('Pengaturan berhasil disimpan!');
                    ui.updateStats();
                });

                document.getElementById('exportDataBtn').addEventListener('click', () => {
                    const data = {
                        savings,
                        goals,
                        userSettings
                    };
                    const dataStr = JSON.stringify(data, null, 2);
                    const blob = new Blob([dataStr], { type: 'application/json' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'personal_savings_data.json';
                    a.click();
                    URL.revokeObjectURL(url);
                });

                document.getElementById('clearDataBtn').addEventListener('click', () => {
                    if (confirm('Yakin ingin menghapus semua data? Tindakan ini tidak dapat dibatalkan.')) {
                        savings = [];
                        goals = [];
                        ui.updateAll();
                        utils.showNotification('Semua data berhasil dihapus!');
                    }
                });

                document.getElementById('changePINBtn').addEventListener('click', () => {
                    alert('Fitur Ubah PIN belum tersedia.');
                });

                document.getElementById('changePasswordBtn').addEventListener('click', () => {
                    alert('Fitur Ubah Password belum tersedia.');
                });
            },

            initFilters: () => {
                document.getElementById('filterType').addEventListener('change', () => {
                    ui.updateTransactionsTable('allTransactionsTable');
                });
                document.getElementById('filterMonth').addEventListener('change', () => {
                    ui.updateTransactionsTable('allTransactionsTable');
                });
            },

            initScroll: () => {
                window.addEventListener('scroll', () => {
                    const scrollTop = window.scrollY;
                    const docHeight = document.documentElement.scrollHeight - window.innerHeight;
                    const scrollPercent = (scrollTop / docHeight) * 100;
                    document.getElementById('scrollProgress').style.width = scrollPercent + '%';
                });
            },

            initWindow: () => {
                window.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape') {
                        modal.hide('transactionModal');
                        modal.hide('goalModal');
                    }
                });
            }
        };

        // Edit and delete functions for transactions and goals
        function editTransaction(id) {
            modal.showTransactionModal(id);
        }

        function deleteTransaction(id) {
            if (confirm('Yakin ingin menghapus transaksi ini?')) {
                savings = savings.filter((s) => s.id !== id);
                ui.updateAll();
                utils.showNotification('Transaksi berhasil dihapus!');
            }
        }

        function editGoal(id) {
            modal.showGoalModal(id);
        }

        function deleteGoal(id) {
            if (confirm('Yakin ingin menghapus target ini?')) {
                goals = goals.filter((g) => g.id !== id);
                ui.updateGoals();
                utils.showNotification('Target berhasil dihapus!');
            }
        }

        function addProgressToGoal(id) {
            const goal = goals.find((g) => g.id === id);
            if (!goal) return;

            const maxAdd = goal.amount - goal.currentAmount;
            if (maxAdd <= 0) {
                utils.showNotification('Target sudah tercapai!', 'error');
                return;
            }

            const addAmountStr = prompt(`Masukkan jumlah progress untuk target "${goal.name}" (maksimal ${utils.formatRupiah(maxAdd)}):`);
            if (!addAmountStr) return;

            const addAmount = parseInt(addAmountStr.replace(/\D/g, ''));
            if (isNaN(addAmount) || addAmount <= 0) {
                utils.showNotification('Jumlah tidak valid!', 'error');
                return;
            }

            if (addAmount > maxAdd) {
                utils.showNotification('Jumlah melebihi target yang tersisa!', 'error');
                return;
            }

            goal.currentAmount += addAmount;
            if (goal.currentAmount >= goal.amount) {
                goal.isCompleted = true;
                utils.showNotification(`Selamat! Target "${goal.name}" telah tercapai!`);
            } else {
                utils.showNotification(`Progress berhasil ditambahkan ke target "${goal.name}"`);
            }
            ui.updateGoals();
        }

        // Initialize app
        document.addEventListener('DOMContentLoaded', () => {
            events.init();
        });
    </script>
</body>
</html>